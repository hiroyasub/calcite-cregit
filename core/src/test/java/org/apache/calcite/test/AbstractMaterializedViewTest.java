begin_unit|revision:1.0.0;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  * Licensed to the Apache Software Foundation (ASF) under one or more  * contributor license agreements.  See the NOTICE file distributed with  * this work for additional information regarding copyright ownership.  * The ASF licenses this file to you under the Apache License, Version 2.0  * (the "License"); you may not use this file except in compliance with  * the License.  You may obtain a copy of the License at  *  * http://www.apache.org/licenses/LICENSE-2.0  *  * Unless required by applicable law or agreed to in writing, software  * distributed under the License is distributed on an "AS IS" BASIS,  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  * See the License for the specific language governing permissions and  * limitations under the License.  */
end_comment

begin_package
package|package
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|test
package|;
end_package

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|adapter
operator|.
name|enumerable
operator|.
name|EnumerableTableScan
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|adapter
operator|.
name|java
operator|.
name|ReflectiveSchema
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|config
operator|.
name|CalciteConnectionConfig
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|jdbc
operator|.
name|CalciteSchema
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|jdbc
operator|.
name|JavaTypeFactoryImpl
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|materialize
operator|.
name|MaterializationService
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|plan
operator|.
name|RelOptCluster
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|plan
operator|.
name|RelOptMaterialization
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|plan
operator|.
name|RelOptUtil
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|prepare
operator|.
name|CalciteCatalogReader
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|rel
operator|.
name|RelNode
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|rel
operator|.
name|core
operator|.
name|RelFactories
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|rel
operator|.
name|logical
operator|.
name|LogicalTableScan
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|rel
operator|.
name|type
operator|.
name|RelDataTypeFactory
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|rex
operator|.
name|RexExecutorImpl
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|schema
operator|.
name|SchemaPlus
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|schema
operator|.
name|Schemas
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|schema
operator|.
name|Table
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql
operator|.
name|SqlNode
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql
operator|.
name|SqlOperatorTable
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql
operator|.
name|fun
operator|.
name|SqlStdOperatorTable
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql
operator|.
name|parser
operator|.
name|SqlParseException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql
operator|.
name|parser
operator|.
name|SqlParser
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql
operator|.
name|validate
operator|.
name|SqlConformance
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql
operator|.
name|validate
operator|.
name|SqlConformanceEnum
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql
operator|.
name|validate
operator|.
name|SqlValidator
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql
operator|.
name|validate
operator|.
name|SqlValidatorCatalogReader
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql
operator|.
name|validate
operator|.
name|SqlValidatorImpl
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql2rel
operator|.
name|SqlToRelConverter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|sql2rel
operator|.
name|StandardConvertletTable
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|tools
operator|.
name|Frameworks
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|tools
operator|.
name|RelBuilder
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|util
operator|.
name|ImmutableBeans
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|util
operator|.
name|Pair
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|calcite
operator|.
name|util
operator|.
name|TestUtil
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|common
operator|.
name|collect
operator|.
name|ImmutableList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|ArrayList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|function
operator|.
name|Function
import|;
end_import

begin_comment
comment|/**  * Abstract class to provide testing environment and utilities for extensions.  */
end_comment

begin_class
specifier|public
specifier|abstract
class|class
name|AbstractMaterializedViewTest
block|{
comment|/**    * Abstract method to customize materialization matching approach.    */
specifier|protected
specifier|abstract
name|List
argument_list|<
name|RelNode
argument_list|>
name|optimize
parameter_list|(
name|TestConfig
name|testConfig
parameter_list|)
function_decl|;
comment|/**    * Method to customize the expected in result.    */
specifier|protected
name|Function
argument_list|<
name|String
argument_list|,
name|Boolean
argument_list|>
name|resultContains
parameter_list|(
specifier|final
name|String
modifier|...
name|expected
parameter_list|)
block|{
return|return
name|s
lambda|->
block|{
for|for
control|(
name|String
name|st
range|:
name|expected
control|)
block|{
if|if
condition|(
operator|!
name|Matchers
operator|.
name|containsStringLinux
argument_list|(
name|st
argument_list|)
operator|.
name|matches
argument_list|(
name|s
argument_list|)
condition|)
block|{
return|return
literal|false
return|;
block|}
block|}
return|return
literal|true
return|;
block|}
return|;
block|}
specifier|protected
name|Sql
name|sql
parameter_list|(
name|String
name|materialize
parameter_list|,
name|String
name|query
parameter_list|)
block|{
return|return
name|ImmutableBeans
operator|.
name|create
argument_list|(
name|Sql
operator|.
name|class
argument_list|)
operator|.
name|withMaterializations
argument_list|(
name|ImmutableList
operator|.
name|of
argument_list|(
name|Pair
operator|.
name|of
argument_list|(
name|materialize
argument_list|,
literal|"MV0"
argument_list|)
argument_list|)
argument_list|)
operator|.
name|withQuery
argument_list|(
name|query
argument_list|)
operator|.
name|withTester
argument_list|(
name|this
argument_list|)
return|;
block|}
comment|/** Checks that a given query can use a materialized view with a given    * definition. */
specifier|private
name|void
name|checkMaterialize
parameter_list|(
name|Sql
name|sql
parameter_list|)
block|{
specifier|final
name|TestConfig
name|testConfig
init|=
name|build
argument_list|(
name|sql
argument_list|)
decl_stmt|;
specifier|final
name|Function
argument_list|<
name|String
argument_list|,
name|Boolean
argument_list|>
name|checker
decl_stmt|;
if|if
condition|(
name|sql
operator|.
name|getChecker
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|checker
operator|=
name|sql
operator|.
name|getChecker
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|checker
operator|=
name|resultContains
argument_list|(
literal|"EnumerableTableScan(table=[["
operator|+
name|testConfig
operator|.
name|defaultSchema
operator|+
literal|", MV0]]"
argument_list|)
expr_stmt|;
block|}
specifier|final
name|List
argument_list|<
name|RelNode
argument_list|>
name|substitutes
init|=
name|optimize
argument_list|(
name|testConfig
argument_list|)
decl_stmt|;
if|if
condition|(
name|substitutes
operator|.
name|stream
argument_list|()
operator|.
name|noneMatch
argument_list|(
name|sub
lambda|->
name|checker
operator|.
name|apply
argument_list|(
name|RelOptUtil
operator|.
name|toString
argument_list|(
name|sub
argument_list|)
argument_list|)
argument_list|)
condition|)
block|{
name|StringBuilder
name|substituteMessages
operator|=
operator|new
name|StringBuilder
argument_list|()
block|;
for|for
control|(
name|RelNode
name|sub
range|:
name|substitutes
control|)
block|{
name|substituteMessages
operator|.
name|append
argument_list|(
name|RelOptUtil
operator|.
name|toString
argument_list|(
name|sub
argument_list|)
argument_list|)
operator|.
name|append
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
throw|throw
operator|new
name|AssertionError
argument_list|(
literal|"Materialized view failed to be matched by optmized results:\n"
operator|+
name|substituteMessages
operator|.
name|toString
argument_list|()
argument_list|)
throw|;
block|}
block|}
end_class

begin_comment
comment|/** Checks that a given query cannot use a materialized view with a given    * definition. */
end_comment

begin_function
specifier|private
name|void
name|checkNoMaterialize
parameter_list|(
name|Sql
name|sql
parameter_list|)
block|{
specifier|final
name|TestConfig
name|testConfig
init|=
name|build
argument_list|(
name|sql
argument_list|)
decl_stmt|;
specifier|final
name|List
argument_list|<
name|RelNode
argument_list|>
name|results
init|=
name|optimize
argument_list|(
name|testConfig
argument_list|)
decl_stmt|;
if|if
condition|(
name|results
operator|.
name|isEmpty
argument_list|()
operator|||
operator|(
name|results
operator|.
name|size
argument_list|()
operator|==
literal|1
operator|&&
operator|!
name|RelOptUtil
operator|.
name|toString
argument_list|(
name|results
operator|.
name|get
argument_list|(
literal|0
argument_list|)
argument_list|)
operator|.
name|contains
argument_list|(
literal|"MV0"
argument_list|)
operator|)
condition|)
block|{
return|return;
block|}
specifier|final
name|StringBuilder
name|errMsgBuilder
init|=
operator|new
name|StringBuilder
argument_list|()
decl_stmt|;
name|errMsgBuilder
operator|.
name|append
argument_list|(
literal|"Optmization succeeds out of expectation: "
argument_list|)
expr_stmt|;
for|for
control|(
name|RelNode
name|res
range|:
name|results
control|)
block|{
name|errMsgBuilder
operator|.
name|append
argument_list|(
name|RelOptUtil
operator|.
name|toString
argument_list|(
name|res
argument_list|)
argument_list|)
operator|.
name|append
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
throw|throw
operator|new
name|AssertionError
argument_list|(
name|errMsgBuilder
operator|.
name|toString
argument_list|()
argument_list|)
throw|;
block|}
end_function

begin_function
specifier|private
name|TestConfig
name|build
parameter_list|(
name|Sql
name|sql
parameter_list|)
block|{
assert|assert
name|sql
operator|!=
literal|null
assert|;
return|return
name|Frameworks
operator|.
name|withPlanner
argument_list|(
parameter_list|(
name|cluster
parameter_list|,
name|relOptSchema
parameter_list|,
name|rootSchema
parameter_list|)
lambda|->
block|{
name|cluster
operator|.
name|getPlanner
argument_list|()
operator|.
name|setExecutor
argument_list|(
operator|new
name|RexExecutorImpl
argument_list|(
name|Schemas
operator|.
name|createDataContext
argument_list|(
literal|null
argument_list|,
literal|null
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
try|try
block|{
specifier|final
name|SchemaPlus
name|defaultSchema
decl_stmt|;
if|if
condition|(
name|sql
operator|.
name|getDefaultSchemaSpec
argument_list|()
operator|==
literal|null
condition|)
block|{
name|defaultSchema
operator|=
name|rootSchema
operator|.
name|add
argument_list|(
literal|"hr"
argument_list|,
operator|new
name|ReflectiveSchema
argument_list|(
operator|new
name|MaterializationTest
operator|.
name|HrFKUKSchema
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|defaultSchema
operator|=
name|CalciteAssert
operator|.
name|addSchema
argument_list|(
name|rootSchema
argument_list|,
name|sql
operator|.
name|getDefaultSchemaSpec
argument_list|()
argument_list|)
expr_stmt|;
block|}
specifier|final
name|RelNode
name|queryRel
init|=
name|toRel
argument_list|(
name|cluster
argument_list|,
name|rootSchema
argument_list|,
name|defaultSchema
argument_list|,
name|sql
operator|.
name|getQuery
argument_list|()
argument_list|)
decl_stmt|;
specifier|final
name|List
argument_list|<
name|RelOptMaterialization
argument_list|>
name|mvs
init|=
operator|new
name|ArrayList
argument_list|<>
argument_list|()
decl_stmt|;
specifier|final
name|RelBuilder
name|relBuilder
init|=
name|RelFactories
operator|.
name|LOGICAL_BUILDER
operator|.
name|create
argument_list|(
name|cluster
argument_list|,
name|relOptSchema
argument_list|)
decl_stmt|;
specifier|final
name|MaterializationService
operator|.
name|DefaultTableFactory
name|tableFactory
init|=
operator|new
name|MaterializationService
operator|.
name|DefaultTableFactory
argument_list|()
decl_stmt|;
for|for
control|(
name|Pair
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
name|pair
range|:
name|sql
operator|.
name|getMaterializations
argument_list|()
control|)
block|{
specifier|final
name|RelNode
name|mvRel
init|=
name|toRel
argument_list|(
name|cluster
argument_list|,
name|rootSchema
argument_list|,
name|defaultSchema
argument_list|,
name|pair
operator|.
name|left
argument_list|)
decl_stmt|;
specifier|final
name|Table
name|table
init|=
name|tableFactory
operator|.
name|createTable
argument_list|(
name|CalciteSchema
operator|.
name|from
argument_list|(
name|rootSchema
argument_list|)
argument_list|,
name|pair
operator|.
name|left
argument_list|,
name|ImmutableList
operator|.
name|of
argument_list|(
name|defaultSchema
operator|.
name|getName
argument_list|()
argument_list|)
argument_list|)
decl_stmt|;
name|defaultSchema
operator|.
name|add
argument_list|(
name|pair
operator|.
name|right
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|relBuilder
operator|.
name|scan
argument_list|(
name|defaultSchema
operator|.
name|getName
argument_list|()
argument_list|,
name|pair
operator|.
name|right
argument_list|)
expr_stmt|;
specifier|final
name|LogicalTableScan
name|logicalScan
init|=
operator|(
name|LogicalTableScan
operator|)
name|relBuilder
operator|.
name|build
argument_list|()
decl_stmt|;
specifier|final
name|EnumerableTableScan
name|replacement
init|=
name|EnumerableTableScan
operator|.
name|create
argument_list|(
name|cluster
argument_list|,
name|logicalScan
operator|.
name|getTable
argument_list|()
argument_list|)
decl_stmt|;
name|mvs
operator|.
name|add
argument_list|(
operator|new
name|RelOptMaterialization
argument_list|(
name|replacement
argument_list|,
name|mvRel
argument_list|,
literal|null
argument_list|,
name|ImmutableList
operator|.
name|of
argument_list|(
name|defaultSchema
operator|.
name|getName
argument_list|()
argument_list|,
name|pair
operator|.
name|right
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return
operator|new
name|TestConfig
argument_list|(
name|defaultSchema
operator|.
name|getName
argument_list|()
argument_list|,
name|queryRel
argument_list|,
name|mvs
argument_list|)
return|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
throw|throw
name|TestUtil
operator|.
name|rethrow
argument_list|(
name|e
argument_list|)
throw|;
block|}
block|}
argument_list|)
return|;
block|}
end_function

begin_function
specifier|private
name|RelNode
name|toRel
parameter_list|(
name|RelOptCluster
name|cluster
parameter_list|,
name|SchemaPlus
name|rootSchema
parameter_list|,
name|SchemaPlus
name|defaultSchema
parameter_list|,
name|String
name|sql
parameter_list|)
throws|throws
name|SqlParseException
block|{
specifier|final
name|SqlParser
name|parser
init|=
name|SqlParser
operator|.
name|create
argument_list|(
name|sql
argument_list|,
name|SqlParser
operator|.
name|Config
operator|.
name|DEFAULT
argument_list|)
decl_stmt|;
specifier|final
name|SqlNode
name|parsed
init|=
name|parser
operator|.
name|parseStmt
argument_list|()
decl_stmt|;
specifier|final
name|CalciteCatalogReader
name|catalogReader
init|=
operator|new
name|CalciteCatalogReader
argument_list|(
name|CalciteSchema
operator|.
name|from
argument_list|(
name|rootSchema
argument_list|)
argument_list|,
name|CalciteSchema
operator|.
name|from
argument_list|(
name|defaultSchema
argument_list|)
operator|.
name|path
argument_list|(
literal|null
argument_list|)
argument_list|,
operator|new
name|JavaTypeFactoryImpl
argument_list|()
argument_list|,
name|CalciteConnectionConfig
operator|.
name|DEFAULT
argument_list|)
decl_stmt|;
specifier|final
name|SqlValidator
name|validator
init|=
operator|new
name|ValidatorForTest
argument_list|(
name|SqlStdOperatorTable
operator|.
name|instance
argument_list|()
argument_list|,
name|catalogReader
argument_list|,
operator|new
name|JavaTypeFactoryImpl
argument_list|()
argument_list|,
name|SqlConformanceEnum
operator|.
name|DEFAULT
argument_list|)
decl_stmt|;
specifier|final
name|SqlNode
name|validated
init|=
name|validator
operator|.
name|validate
argument_list|(
name|parsed
argument_list|)
decl_stmt|;
specifier|final
name|SqlToRelConverter
operator|.
name|Config
name|config
init|=
name|SqlToRelConverter
operator|.
name|configBuilder
argument_list|()
operator|.
name|withTrimUnusedFields
argument_list|(
literal|true
argument_list|)
operator|.
name|withExpand
argument_list|(
literal|true
argument_list|)
operator|.
name|withDecorrelationEnabled
argument_list|(
literal|true
argument_list|)
operator|.
name|build
argument_list|()
decl_stmt|;
specifier|final
name|SqlToRelConverter
name|converter
init|=
operator|new
name|SqlToRelConverter
argument_list|(
parameter_list|(
name|rowType
parameter_list|,
name|queryString
parameter_list|,
name|schemaPath
parameter_list|,
name|viewPath
parameter_list|)
lambda|->
block|{
throw|throw
operator|new
name|UnsupportedOperationException
argument_list|(
literal|"cannot expand view"
argument_list|)
throw|;
block|}
argument_list|,
name|validator
argument_list|,
name|catalogReader
argument_list|,
name|cluster
argument_list|,
name|StandardConvertletTable
operator|.
name|INSTANCE
argument_list|,
name|config
argument_list|)
decl_stmt|;
return|return
name|converter
operator|.
name|convertQuery
argument_list|(
name|validated
argument_list|,
literal|false
argument_list|,
literal|true
argument_list|)
operator|.
name|rel
return|;
block|}
end_function

begin_comment
comment|/** Validator for testing. */
end_comment

begin_class
specifier|private
specifier|static
class|class
name|ValidatorForTest
extends|extends
name|SqlValidatorImpl
block|{
name|ValidatorForTest
parameter_list|(
name|SqlOperatorTable
name|opTab
parameter_list|,
name|SqlValidatorCatalogReader
name|catalogReader
parameter_list|,
name|RelDataTypeFactory
name|typeFactory
parameter_list|,
name|SqlConformance
name|conformance
parameter_list|)
block|{
name|super
argument_list|(
name|opTab
argument_list|,
name|catalogReader
argument_list|,
name|typeFactory
argument_list|,
name|Config
operator|.
name|DEFAULT
operator|.
name|withSqlConformance
argument_list|(
name|conformance
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_class

begin_comment
comment|/**    * Processed testing definition.    */
end_comment

begin_class
specifier|protected
specifier|static
class|class
name|TestConfig
block|{
specifier|public
specifier|final
name|String
name|defaultSchema
decl_stmt|;
specifier|public
specifier|final
name|RelNode
name|queryRel
decl_stmt|;
specifier|public
specifier|final
name|List
argument_list|<
name|RelOptMaterialization
argument_list|>
name|materializations
decl_stmt|;
specifier|public
name|TestConfig
parameter_list|(
name|String
name|defaultSchema
parameter_list|,
name|RelNode
name|queryRel
parameter_list|,
name|List
argument_list|<
name|RelOptMaterialization
argument_list|>
name|materializations
parameter_list|)
block|{
name|this
operator|.
name|defaultSchema
operator|=
name|defaultSchema
expr_stmt|;
name|this
operator|.
name|queryRel
operator|=
name|queryRel
expr_stmt|;
name|this
operator|.
name|materializations
operator|=
name|materializations
expr_stmt|;
block|}
block|}
end_class

begin_comment
comment|/** Fluent class that contains information necessary to run a test. */
end_comment

begin_interface
specifier|public
interface|interface
name|Sql
block|{
specifier|default
name|void
name|ok
parameter_list|()
block|{
name|getTester
argument_list|()
operator|.
name|checkMaterialize
argument_list|(
name|this
argument_list|)
expr_stmt|;
block|}
specifier|default
name|void
name|noMat
parameter_list|()
block|{
name|getTester
argument_list|()
operator|.
name|checkNoMaterialize
argument_list|(
name|this
argument_list|)
expr_stmt|;
block|}
annotation|@
name|ImmutableBeans
operator|.
name|Property
name|CalciteAssert
operator|.
name|SchemaSpec
name|getDefaultSchemaSpec
parameter_list|()
function_decl|;
name|Sql
name|withDefaultSchemaSpec
parameter_list|(
name|CalciteAssert
operator|.
name|SchemaSpec
name|spec
parameter_list|)
function_decl|;
annotation|@
name|ImmutableBeans
operator|.
name|Property
name|List
argument_list|<
name|Pair
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
argument_list|>
name|getMaterializations
parameter_list|()
function_decl|;
name|Sql
name|withMaterializations
parameter_list|(
name|List
argument_list|<
name|Pair
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
argument_list|>
name|materialize
parameter_list|)
function_decl|;
annotation|@
name|ImmutableBeans
operator|.
name|Property
name|String
name|getQuery
parameter_list|()
function_decl|;
name|Sql
name|withQuery
parameter_list|(
name|String
name|query
parameter_list|)
function_decl|;
annotation|@
name|ImmutableBeans
operator|.
name|Property
name|Function
argument_list|<
name|String
argument_list|,
name|Boolean
argument_list|>
name|getChecker
parameter_list|()
function_decl|;
name|Sql
name|withChecker
parameter_list|(
name|Function
argument_list|<
name|String
argument_list|,
name|Boolean
argument_list|>
name|checker
parameter_list|)
function_decl|;
annotation|@
name|ImmutableBeans
operator|.
name|Property
name|AbstractMaterializedViewTest
name|getTester
parameter_list|()
function_decl|;
name|Sql
name|withTester
parameter_list|(
name|AbstractMaterializedViewTest
name|tester
parameter_list|)
function_decl|;
block|}
end_interface

unit|}
end_unit

